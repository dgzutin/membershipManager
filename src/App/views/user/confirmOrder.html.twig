{% extends 'base.html.twig' %}

{% block mainPanel %}

    <!-- Bootstrap core CSS -->
    <link href="{{ baseUrl }}/assets/form-helper/css/bootstrap-formhelpers.min.css" rel="stylesheet">

    <!-- Placed at the end of the document so the pages load faster -->
    <script src="{{ baseUrl }}/assets/form-helper/js/bootstrap-formhelpers.min.js"></script>
    <script src="{{ baseUrl }}/assets/bootstrap-validator/validator.min.js"></script>

    <!-- progress Steps CSS -->
    <link href="{{ baseUrl }}/assets/css/progressSteps.css" rel="stylesheet">

    <!-- progress Steps CSS -->
    <link href="{{ baseUrl }}/assets/css/progressSteps.css" rel="stylesheet">

    <div class="row bs-wizard" style="border-bottom:0;">

        <div class="col-xs-3 bs-wizard-step complete">
            <div class="text-center bs-wizard-stepnum">Step 1</div>
            <div class="progress"><div class="progress-bar"></div></div>
            <a href="#" class="bs-wizard-dot"></a>
            <div class="bs-wizard-info text-center">Your Membership</div>
        </div>

        <div class="col-xs-3 bs-wizard-step complete"><!-- complete -->
            <div class="text-center bs-wizard-stepnum">Step 2</div>
            <div class="progress"><div class="progress-bar"></div></div>
            <a href="#" class="bs-wizard-dot"></a>
            <div class="bs-wizard-info text-center">Membership and Billing Information</div>
        </div>

        <div class="col-xs-3 bs-wizard-step active"><!-- complete -->
            <div class="text-center bs-wizard-stepnum">Step 3</div>
            <div class="progress"><div class="progress-bar"></div></div>
            <a href="#" class="bs-wizard-dot"></a>
            <div class="bs-wizard-info text-center">Confirm Order and agree with terms</div>
        </div>

        <div class="col-xs-3 bs-wizard-step disabled"><!-- active -->
            <div class="text-center bs-wizard-stepnum">Step 4</div>
            <div class="progress"><div class="progress-bar"></div></div>
            <a href="#" class="bs-wizard-dot"></a>
            <div class="bs-wizard-info text-center">Invoice and Payment</div>
        </div>

    </div>

    <div class="panel-group">

        <div class="panel panel-primary">
            <div class="panel-heading"><strong>Confirm your order</strong></div>
            <div class="panel-body">

                <strong>Name and Invoice address:</strong>

                <br><a href="{{ path_for('userProfile')}}">{{ form.name }}</a>
                <br>{{ form.institution }}
                <br>{{ form.street }}
                <br>{{ form.zip }} - {{ form.city }}
                <br> <span class="bfh-countries" data-country="{{ form.country }}" data-flags="true"></span>
                <br>{{ form.vat }}
                <br>{{ form.reference }}

                <h4>Your order:</h4>

                <div class="well">
                    <table class="table table-condensed" id="items" cellspacing="0" width="100%">
                        <thead>
                        <tr>
                            <th>Item</th>
                            <th></th>
                            <th>Quantity</th>
                            <th>Unit Price</th>
                            <th>Amount</th>
                            <th></th>
                        </tr>
                        </thead>
                        <tbody>
                        {%  for item in items %}
                            <tr class="">
                                <td>{{ item.name }}</td>
                                <td></td>
                                <td>{{ item.quantity }}</td>
                                <td>{{ item.unitPrice }}</td>
                                <td>{{ item.totalPrice }}</td>
                                <td>
                                    <a href="{{ path_for('removeItemfromCartUser', { 'itemId': item.id }) }}">
                                        <span class="fa fa-trash-o"></span>
                                    </a>
                                </td>
                            </tr>
                        {% endfor %}

                        <tr>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td><strong>TOTAL:</strong></td>
                            <td>{{ systemInfo.settings.systemCurrency }} {{ totalPrice }}</td>
                        </tr>

                        </tbody>
                    </table>
                </div>

                <hr>

                <form id="form_billing_info" data-toggle="validator" role="form" method="post" action="{{ path_for('processOrder')}}">

                    <input type="hidden" name="name" id="first_name" class="form-control" placeholder="Name" value="{{ form.name }}">
                    <input type="hidden" name="institution" id="institution" class="form-control " placeholder="Institution" value="{{ form.institution }}">
                    <input required type="hidden" name="street" id="street" class="form-control " placeholder="street" value="{{ form.street }}">
                    <input type="hidden" name="country" id="country" value="{{ form.country }}">
                    <input required="required" type="hidden" name="city" id="city" class="form-control " placeholder="" value="{{ form.city }}" >
                    <input type="hidden" name="zip" id="zip" class="form-control " placeholder="" value="{{ form.zip }}">
                    <input type="hidden" name="vat" id="vat" class="form-control " placeholder="" value="{{ form.vat }}">
                    <input type="hidden" name="reference" id="reference" class="form-control " placeholder="" value="{{ form.reference }}">
                    <input type="hidden" name="comments" id="comments" class="form-control " placeholder="" value="{{ membershipData.comments }}" >

                    <h4>Invoice terms:</h4>
                    {{ invoiceTerms }}


                    <p class="text-right">
                        <a class="btn btn-primary btn-md" href="{{ path_for('orderSummaryUser')}}" role="button">Back: Edit Invoice Address</a>
                        <a id="place_order_button" class="btn btn-success" data-toggle="modal" data-target="#place_order">Confirm Purchase</a>

                    </p>


                    <!-- Dialog with terms and conditions -->
                    <div class="modal fade" id="place_order" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                        <div class="modal-dialog">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                                    <h4 class="modal-title" id="myModalLabel">Confirm order?</h4>
                                </div>
                                <div class="modal-body">
                                    I confirm that I have read and agree with the invoice and membership terms.
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                                    <button type="submit" class="btn btn-primary" form="form_billing_info">Agree and place order</button>
                                </div>
                            </div>
                            <!-- /.modal-content -->
                        </div>
                        <!-- /.modal-dialog -->
                    </div>

                </form>

                <hr>

            </div>
        </div>

    </div>




{% endblock %}

